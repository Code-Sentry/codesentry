import json

class VulnerabilityManager:
    
    def __init__(self, result):
        self.result = result
        
    def getVulnerabilities(self):
        return self.result['results']
    
    def getCountVulnerabilities(self):
        return len(self.result['results'])
    
    def getPathsScanned(self):
        return self.result['paths']['scanned']
    
    def getVulnrebilitySeverityNumber(self):
        print('chega aqui')
        result = self.result
        warning_severity = 0
        info_severity = 0
        error_severity = 0
        unknown_severity = 0
        
        for data in result['results']:
            if 'extra' in data and 'severity' in data['extra'] and isinstance(data['extra']['severity'], str):
                severity = data['extra']['severity'].upper()
                
                if severity == 'WARNING':
                    warning_severity += 1
                elif severity == 'INFO':
                    info_severity += 1
                elif severity == 'ERROR':
                    error_severity += 1
                else:
                    unknown_severity += 1
            else:
                unknown_severity += 1 
        
        return json.dumps({'warning': warning_severity, 'info': info_severity, 'error': error_severity, 'unknown': unknown_severity})